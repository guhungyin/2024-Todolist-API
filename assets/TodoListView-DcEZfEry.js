import{u as E,r as n,i as F,j as P,o as c,a as r,b as t,t as w,k as _,w as x,v as A,l as U,n as T,F as k,m as q,q as j}from"./index-CT04YmL-.js";import{a as v,i as d}from"./index-d484KRIS.js";const O="/2024-Todolist-API/assets/logo-Dq7ACwgP.png",R={id:"todoListPage",class:"bg-half"},Z=t("h1",null,[t("a",null,[t("img",{src:O,alt:""})])],-1),G={class:"todo_sm"},J={href:"#"},K={class:"conatiner todoListPage vhContainer"},Q={class:"todoList_Content"},W={class:"inputBox"},X=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-plus-lg",viewBox:"0 0 16 16"},[t("path",{"fill-rule":"evenodd",d:"M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"})],-1),Y=[X],tt={key:0},et={class:"todoList_list"},ot={class:"todoList_tab"},st={class:"todoList_items"},at={class:"todoList_item"},lt={class:"todoList_label justify-content-between"},nt={class:"d-flex"},ut=["onClick","onUpdate:modelValue"],it={class:"d-flex"},ct=["onClick"],rt=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-pencil-square",viewBox:"0 0 16 16"},[t("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),t("path",{"fill-rule":"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"})],-1),dt=[rt],vt=["onClick"],ht=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-trash3",viewBox:"0 0 16 16"},[t("path",{d:"M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"})],-1),gt=[ht],pt={class:"todoList_statistics"},h="https://todolist-api.hexschool.io",mt={__name:"TodoListView",setup(_t){const z=E(),i=n(),$=n({uid:"",nickname:""}),H=async()=>{try{const e=document.cookie.replace(/(?:(?:^|.*;\s*)tokenName\s*=\s*([^;]*).*$)|^.*$/,"$1");i.value=e;const o=await v.get(`${h}/users/checkout`,{headers:{Authorization:i.value}});$.value=o.data,d.success("登入成功",{theme:"auto",type:"default",autoClose:3e3,dangerouslyHTMLString:!0})}catch(e){console.log(e)}};F(()=>{H(),g()});const S=async()=>{try{const e=await v.post(`${h}/users/sign_out`,{},{headers:{Authorization:i.value}});console.log(e),d.success(e.data.message,{theme:"auto",type:"default",autoClose:3e3,dangerouslyHTMLString:!0}),z.push({name:"loging"})}catch(e){console.log(e),d.error("登出失敗",{theme:"auto",type:"default",dangerouslyHTMLString:!0})}},a=n([]),f=n([]),y=n([]),m=n(0),g=async()=>{try{const e=await v.get(`${h}/todos`,{headers:{Authorization:i.value}});a.value=e.data.data}catch(e){console.log(e)}},p=n({content:""}),V=async()=>{try{if(p.value.content===""){d.warn("請輸入內容",{theme:"auto",type:"default",autoClose:2e3,dangerouslyHTMLString:!0});return}else{const e=await v.post(`${h}/todos`,p.value,{headers:{Authorization:i.value}});console.log(e),g(),p.value={content:""},d.success("新增完成",{theme:"auto",type:"default",autoClose:2e3,dangerouslyHTMLString:!0})}}catch(e){console.log(e)}},u=n({id:"",content:""}),M=()=>{u.value={id:"",content:""}},B=e=>{const o=a.value.findIndex(s=>s.id===e);u.value.id=e,u.value.content=a.value[o].content},D=async()=>{try{const e=await v.put(`${h}/todos/${u.value.id}`,{content:u.value.content},{headers:{Authorization:i.value}});g(),M(),d.success("更新成功",{theme:"auto",type:"default",autoClose:2e3,dangerouslyHTMLString:!0})}catch(e){console.log(e)}},I=async e=>{try{const o=await v.delete(`${h}/todos/${e}`,{headers:{Authorization:i.value}});console.log(o),g(),d.success(o.data.message,{theme:"auto",type:"default",autoClose:2e3,dangerouslyHTMLString:!0})}catch(o){console.log(o)}},N=async(e,o)=>{try{const s=await v.patch(`${h}/todos/${e}/toggle`,{},{headers:{Authorization:i.value}});g().then(()=>{o===!1?(f.value=a.value.filter(l=>l.status===!1),a.value=f.value):o===!0?(y.value=a.value.filter(l=>l.status===!0),a.value=y.value):a.value=s.data.data}),console.log(s),d.success(s.data.message,{theme:"auto",type:"default",autoClose:2e3,dangerouslyHTMLString:!0})}catch(s){console.log(s)}},C=n(0),b=n(0);P(()=>{C.value=0,b.value=0,a.value.forEach(e=>{e.status==!0?C.value++:b.value++})});const L=e=>{m.value=e,g().then(()=>{e===1?(f.value=a.value.filter(o=>o.status===!1),a.value=f.value):e===2?(y.value=a.value.filter(o=>o.status===!0),a.value=y.value):a.value=[...a.value]})};return(e,o)=>(c(),r("div",R,[t("nav",null,[Z,t("ul",null,[t("li",G,[t("a",J,[t("span",null,w($.value.nickname)+"的代辦",1)])]),t("li",null,[t("a",{href:"#",onClick:_(S,["prevent"])},"登出")])])]),t("div",K,[t("div",Q,[t("div",W,[x(t("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>p.value.content=s),type:"text",placeholder:"請輸入待辦事項"},null,512),[[A,p.value.content]]),t("a",{href:"#",onClick:_(V,["prevent"])},Y)]),a.value.value?(c(),r("h5",tt,"目前尚無代辦事項")):U("",!0),t("div",et,[t("ul",ot,[t("li",null,[t("a",{onClick:o[1]||(o[1]=_(s=>L(0),["prevent"])),href:"#",class:T(m.value===0?"active":"")},"全部",2)]),t("li",null,[t("a",{onClick:o[2]||(o[2]=_(s=>L(1),["prevent"])),href:"#",class:T(m.value===1?"active":"")},"待完成",2)]),t("li",null,[t("a",{onClick:o[3]||(o[3]=_(s=>L(2),["prevent"])),href:"#",class:T(m.value===2?"active":"")},"已完成",2)])]),t("div",st,[t("ul",at,[(c(!0),r(k,null,q(a.value,s=>(c(),r("li",{key:s.id},[t("label",lt,[t("div",nt,[u.value.id===s.id?x((c(),r("input",{key:0,type:"text",class:"form-control col","onUpdate:modelValue":o[4]||(o[4]=l=>u.value.content=l)},null,512)),[[A,u.value.content]]):(c(),r(k,{key:1},[x(t("input",{onClick:l=>N(s.id,s.status),"onUpdate:modelValue":l=>s.status=l,class:"todoList_input",type:"checkbox",value:"true"},null,8,ut),[[j,s.status]]),t("span",null,w(s.content),1)],64))]),t("div",it,[u.value.id===s.id?(c(),r(k,{key:0},[t("button",{class:"btn btn-outline-secondary me-2",type:"button",onClick:o[5]||(o[5]=l=>M())},"取消"),t("button",{class:"btn btn-outline-success",type:"button",onClick:o[6]||(o[6]=l=>D())},"確認")],64)):(c(),r(k,{key:1},[t("button",{onClick:l=>B(s.id),class:"btn text-success",type:"button"},dt,8,ct),t("button",{onClick:l=>I(s.id),class:"btn text-danger",type:"button"},gt,8,vt)],64))])])]))),128))]),t("div",pt,[t("p",null,w(b.value)+" 個未完成項目",1),t("p",null,w(C.value)+" 個已完成項目",1)])])])])])]))}};export{mt as default};
